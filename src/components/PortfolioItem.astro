---
import { Image } from "astro:assets";
import type { PortfolioEntry } from "../data/portfolio";

const { portfolio } = Astro.props as { portfolio: PortfolioEntry };

const href = portfolio.url;
const isExternal = true; // assume portfolio links are external
const relAttrs = isExternal ? "noreferrer noopener" : undefined;
const targetAttr = isExternal ? "_blank" : undefined;
---

<a
  class="portfolio-item glass-strong anim-soft-in anim-base"
  href={href}
  rel={relAttrs}
  target={targetAttr}
  aria-label={`${portfolio.title} â€“ ${portfolio.description}`}
>
  <span class="portfolio-item__overlay" aria-hidden="true"></span>
  <span class="portfolio-item__image" aria-hidden="true">
    <Image
      src={portfolio.image}
      alt={`${portfolio.title} preview`}
      width={120}
      height={80}
      loading="lazy"
      decoding="async"
    />
  </span>

  <span class="portfolio-item__content">
    <span class="portfolio-item__heading">
      <span class="portfolio-item__title">{portfolio.title}</span>
      {
        portfolio.category && (
          <span class="portfolio-item__category">{portfolio.category}</span>
        )
      }
    </span>
    <span class="portfolio-item__description">{portfolio.description}</span>
  </span>

  <span class="portfolio-item__cta" aria-hidden="true">
    <svg
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="1.6"
    >
      <path
        stroke-linecap="round"
        stroke-linejoin="round"
        d="M5 12h14M13 6l6 6-6 6"></path>
    </svg>
  </span>
</a>

<style>
  .portfolio-item {
    position: relative;
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: clamp(14px, 1.8vw, 22px);
    padding: clamp(16px, 1.8vw, 22px) clamp(18px, 2.4vw, 28px);
    border-radius: var(--radius-lg);
    color: inherit;
    text-decoration: none;
    overflow: hidden;
    isolation: isolate;
    transition:
      transform var(--motion-duration-md) var(--motion-ease-emphasized),
      background var(--motion-duration-md) var(--motion-ease-standard),
      box-shadow var(--motion-duration-md) var(--motion-ease-standard);
  }

  .portfolio-item:hover {
    transform: translateY(-4px);
    box-shadow: 0 16px 40px -14px rgb(0 0 0 / 0.65);
  }

  .portfolio-item:focus-visible {
    box-shadow:
      0 0 0 2px rgb(var(--accent-1) / 0.6),
      0 0 0 5px rgb(var(--glass) / 0.45);
  }

  .portfolio-item__overlay {
    position: absolute;
    inset: -40%;
    background: radial-gradient(
      circle at top right,
      rgb(var(--accent-1) / 0.22),
      transparent 60%
    );
    opacity: 0;
    transition: opacity var(--motion-duration-md) var(--motion-ease-standard);
    z-index: -1;
  }

  .portfolio-item:hover .portfolio-item__overlay {
    opacity: 1;
  }

  .portfolio-item__image {
    width: clamp(80px, 8vw, 120px);
    height: clamp(60px, 6vw, 90px);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--radius-md);
    background: rgb(var(--glass) / 0.08);
    border: 1px solid rgb(var(--glass) / 0.16);
    box-shadow:
      0 6px 20px -10px rgb(0 0 0 / 0.65),
      0 0 0 1px rgb(var(--glass) / 0.12) inset;
    overflow: hidden;
    transition: transform var(--motion-duration-md)
      var(--motion-ease-emphasized);
  }

  .portfolio-item:hover .portfolio-item__image {
    transform: scale(1.05);
  }

  .portfolio-item__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: var(--radius-md);
  }

  .portfolio-item__content {
    display: grid;
    gap: 6px;
    justify-items: start;
  }

  .portfolio-item__heading {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 8px;
  }

  .portfolio-item__title {
    font-size: clamp(1.05rem, 0.98rem + 0.3vw, 1.28rem);
    font-weight: 600;
    letter-spacing: 0.01em;
  }

  .portfolio-item__category {
    padding: 4px 10px;
    border-radius: var(--radius-pill);
    background: rgb(var(--glass) / 0.18);
    backdrop-filter: blur(4px);
    border: 1px solid rgb(var(--glass) / 0.25);
    font-size: clamp(0.68rem, 0.62rem + 0.18vw, 0.78rem);
    letter-spacing: 0.06em;
    text-transform: uppercase;
    color: rgb(var(--text-1));
  }

  .portfolio-item__description {
    font-size: clamp(0.82rem, 0.76rem + 0.18vw, 0.9rem);
    color: rgb(var(--text-1));
    text-align: left;
    display: block;
    width: 100%;
  }

  .portfolio-item__cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: clamp(34px, 3.6vw, 42px);
    height: clamp(34px, 3.6vw, 42px);
    border-radius: var(--radius-md);
    background: rgb(var(--glass) / 0.08);
    border: 1px solid rgb(var(--glass) / 0.14);
    color: rgb(var(--text-0));
    opacity: 0.9;
    transition:
      transform var(--motion-duration-md) var(--motion-ease-emphasized),
      opacity var(--motion-duration-sm) var(--motion-ease-standard);
  }

  .portfolio-item:hover .portfolio-item__cta {
    transform: translateX(4px);
    opacity: 1;
  }

  .portfolio-item__cta svg {
    width: 18px;
    height: 18px;
  }

  @media (max-width: 640px) {
    .portfolio-item {
      grid-template-columns: auto 1fr;
      grid-template-rows: auto auto;
      gap: 14px;
    }

    .portfolio-item__cta {
      grid-column: 2 / -1;
      grid-row: 2;
      justify-self: end;
    }
  }
</style>
